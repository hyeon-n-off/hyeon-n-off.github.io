---
title: "λ¨λΈν•™μµλ²•II: κ²½μ‚¬ ν•κ°•λ²•"
date: 2024-03-02 10:00:00 +09:00
categories: [Deep Learning Basic]
tags:
  [
    .
    .
    .
  ]
---
![index](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/1a8f1f90-2070-425b-99dc-9f5d6d251e52){: width="60%"}

μ΄ ν¬μ¤ν…μ—μ„λ” κ²½μ‚¬ ν•κ°•λ²•μ— λ€ν•΄μ„ λ‹¤λ¤„λ³Ό κ²ƒμ΄λ‹¤.

<hr>

### **λ―Έλ¶„(Differentiation)**
λ³€μμ μ›€μ§μ„μ— λ”°λΌ ν•¨μκ°’μ λ³€ν™”λ¥Ό μΈ΅μ •ν•λ” λ„κµ¬  <br>
μµμ ν™”μ—μ„ μ μΌ λ§μ΄ μ‚¬μ©ν•λ” κΈ°λ²•  <br>

![diff_2](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/42bac28c-975c-4ab2-9f7a-cef356fe8c54){: width="60%"}

<br>
μ†μ‹¤ ν•¨μμ νΉμ • μ„μΉμ—μ„ μ–΄λ–»κ² νλΌλ―Έν„°λ¥Ό μ΅°μ •ν•΄μ•Ό Lossκ°€ μ¤„μ–΄λ“λ”μ§€ μ¶”μ •ν•μ—¬ νλΌλ―Έν„° κ°’μ„ λ³€ν™”μ‹ν‚¨λ‹¤.  <br>
κ²°κµ­ νλΌλ―Έν„°λ¥Ό λ³€ν™”μ‹ν‚¬ λ• Lossκ°€ μ–΄λ–»κ² λ³€ν™”ν•λ”μ§€λ¥Ό <span style="background-color:#fff5b1"> λ―Έλ¶„</span>μ„ ν†µν•΄ ν™•μΈν•  μ μλ‹¤.  <br>
<br>
<br>

![Diff_gif](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/9aa079ff-396e-46ad-aecd-bb2abf2581a3){: width="80%"}(https://towardsdatascience.com/stochastic-gradient-descent-for-machine-learning-clearly-explained-cadcc17d3d11)

#### **2μ°¨μ› ν‰λ©΄μ—μ„μ λ―Έλ¶„**
xμ—μ„μ λ―Έλ¶„κ°’μ€ fμ μ£Όμ–΄μ§„ μ  (x,f(x))μ—μ„μ μ ‘μ„ μ κΈ°μΈκΈ°μ™€ λ™μΌ  <br>
μ–΄λ–¤ μ μ—μ„μ ν•¨μμ κΈ°μΈκΈ°λ¥Ό μ•λ©΄ μ–΄λ λ°©ν–¥μΌλ΅ μ μ„ μ›€μ§μ—¬μ•Ό ν•¨μκ°’μ΄ <span style="color:red">μ¦κ°€</span> or <span style="color:blue">κ°μ†</span>ν•λ”μ§€ μ• μ μλ‹¤.  <br>

![diff_3](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/c885331b-0f0d-48ff-a528-206ea9d3d78e)

>  μ†μ‹¤ ν•¨μ(Loss Function ; Cost Function)κ°€ μµμ†μΈ x(νλΌλ―Έν„°)λ¥Ό μ°Ύλ” κ²ƒμ΄ κ²½μ‚¬ ν•κ°•λ²•μ λ©ν‘!
{: .prompt-tip }

<br>

#### **νΈλ―Έλ¶„(partial differentiation)**
λ²΅ν„°λ¥Ό μ…λ ¥κ°’μΌλ΅ λ°›λ” λ‹¤λ³€μ ν•¨μμ κ²½μ°, κ° λ³€μμ— λ€ν•΄ λ―Έλ¶„ν• νΈλ―Έλ¶„μ„ μ‚¬μ©ν•λ‹¤.  <br>


<p align="center"><img src="https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/156c2835-f594-448d-a11d-3bddda64d0a8" width="40%"></p>  <br>

κ° λ³€μμ— λ€ν• νΈλ―Έλ¶„μ„ λ‚νƒ€λ‚Έ κ·Έλλ””μ–ΈνΈ(gradient) λ²΅ν„°λ¥Ό μ΄μ©ν•λ©΄ λ§μ°¬κ°€μ§€λ΅ λ‹¤λ³€μ ν•¨μμ κΈ°μΈκΈ°λ¥Ό μ• μ μλ‹¤.
<p align="center"><img src="https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/f60e9383-53f1-42c2-bb45-c1e85f12d057" width="40%"></p>  <br>

<hr>

### **κ²½μ‚¬ ν•κ°•λ²•(Gradient Descent, GD)**
κΈ°μΈκΈ°(f'(x))κ°€ κ°μ†ν•λ” λ°©ν–¥μΌλ΅ xλ¥Ό μ›€μ§μ—¬μ„ f(x)μ μµμ†κ°’μ„ μ°Ύλ” μ•κ³ λ¦¬μ¦  <br>
λ”¥λ¬λ‹μ—μ„λ” μ†μ‹¤ ν•¨μμ κ·Έλλ””μ–ΈνΈκ°€ κ°μ†ν•λ” λ°©ν–¥μΌλ΅ νλΌλ―Έν„°λ¥Ό μ›€μ§μ—¬ μ†μ‹¤ ν•¨μμ μµμ†κ°’μ„ μ°Ύλ”λ‹¤.  <br>

<p align="center"><img src="https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/4625d2aa-f1bd-457f-bb44-50dc9c67751d" width="65%"></p>  <br>

> **κ²½μ‚¬ ν•κ°•λ²•μ ν•™μµκ³Όμ •**  <br>
> 1. λ¨λΈ νλΌλ―Έν„° πƒ={π‘,π‘} μ΄κΈ°ν™”  <br>
> 2. μ „μ²΄ ν•™μµ λ°μ΄ν„°μ…‹μ—μ„μ μ†μ‹¤ ν•¨μ κ°’μ„ κµ¬ν•κ³  λ―Έλ¶„μ„ ν†µν•΄ μ΄λ¥Ό μµμ†ν™”ν•λ” λ¨λΈ νλΌλ―Έν„°λ¥Ό μ°Ύλ”λ‹¤.  <br>
>![math_4](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/6175a6b8-7815-4390-a94d-e6f5bcc6dfdd){: width="60%"}
> 3. 2λ² κ³Όμ •μ„ λ°λ³µν•λ‹¤κ°€ μΆ…λ£ μ΅°κ±΄μ΄ μ¶©μ΅±λλ©΄ ν•™μµμ΄ λλ‚λ‹¤.  <br>
>![math_5](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/fe847ce6-c1e3-4a80-9202-1ce03ef2992d){: width="35%"}  <br>
>![sd](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/ee1f902e-b74c-43e8-996e-8fb06c51d6c9){: width="60%"}  <br>
> λ―Έλ¶„κ°’(κΈ°μΈκΈ°)μ΄(κ°€) μ μ  μ‘μ•„μ§€λ©΄μ„ νλΌλ―Έν„°μ λ³€ν™”λ‰λ„ μ‘μ•„μ§„λ‹¤.  <br>
>![gradient_descent_parameter_a](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/d2ec4133-2ae0-4502-8279-67336430fef6){: width="80%"}(https://baptiste-monpezat.github.io/blog/stochastic-gradient-descent-for-machine-learning-clearly-explained)

#### **κ²½μ‚¬ ν•κ°•λ²•μ ν•κ³„ λ° ν•΄κ²°λ°©μ•**
![sd_limit](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/cbff5ff3-6d62-473b-8398-b9e3d34f4d7b){: width="60%"}  <br>
μ§€μ—­ μµμ†μ (Local minimum)μ΄λ‚, λ†’μ€ κ³³μ—μ„μ ν‰νƒ„ν• μ§€μ (Plateau)λ¥Ό λ§λ‚κ² λλ©΄ λ”μ΄μƒ ν•™μµμ΄ μΌμ–΄λ‚μ§€ μ•κ²λλ‹¤. μ΄λ΄ κ²½μ°μ—λ” μ–΄λ–»κ² ν•΄μ•Όν• κΉ?  <br>
<br>

![GD_local](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/d7088da5-94d8-4dcf-aca7-8dca03e207ea){: width="60%"}(https://towardsdatascience.com/a-visual-explanation-of-gradient-descent-methods-momentum-adagrad-rmsprop-adam-f898b102325c)

> **ν•΄κ²°λ°©μ•**
> 1. νλΌλ―Έν„° μ΄κΈ°ν™”λ¥Ό κµ‰μ¥ν μν•λ‹¤. (μ—¬λ¬ μ΄κΈ°ν™” κΈ°λ²•, pretraining)
> 2. Learning Stepμ„ λ°”κΎΌλ‹¤.
> 3. λ¨λΈ κµ¬μ΅°λ¥Ό λ°”κΏ”μ„ κ·Έλν”„ λ¨μ–‘μ„ λ°”κΎΌλ‹¤. <br>

<br>
β‘΅ Learning Stepμ„ λ°”κΎΌλ‹¤.

![image](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/244244dc-d38e-4f9d-9dad-d12991a3ddb1){: width="80%"}(https://www.bdhammel.com/learning-rates/)  <br>

β‘Ά λ¨λΈ κµ¬μ΅°λ¥Ό λ°”κΏ”μ„ κ·Έλν”„ λ¨μ–‘μ„ λ°”κΎΌλ‹¤.  <br>
λ¨λΈ κµ¬μ΅°λ” μ–΄λ–»κ² λ°”κΏ€ μ μμ„κΉ? β†’ SGDλ¥Ό ν†µν•΄μ„!

<hr>

### **ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²•(Stochastic Gradient Descent, SGD)**

#### **κ²½μ‚¬ ν•κ°•λ²•μ νμ΄ν”„λΌμΈ**
![math_6](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/08949746-37cf-4297-96e4-63581b189c00)  <br>
<br>

#### **ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²•**  <br>
λ¨λ“  λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•΄μ„ κµ¬ν• κ²½μ‚¬λ¥Ό ν†µν•΄ νλΌλ―Έν„°λ¥Ό ν• λ² μ—…λ°μ΄νΈ ν•λ” λ€μ‹ ,  <br>
λ°μ΄ν„° ν• κ° λλ” μΌλ¶€λ¥Ό ν™μ©ν•μ—¬ κµ¬ν• κ²½μ‚¬λ΅ μ—¬λ¬ λ² μ—…λ°μ΄νΈλ¥Ό μ§„ν–‰ν•λ” λ°©λ²•   <br>

- SGDλ¥Ό ν†µν•΄ ν• λ²μ ν•™μµμ„ ν•λ” λ°μ— μ‚¬μ©λλ” λ°μ΄ν„° μƒν”μ μ§‘ν•©μ„ 'λ―Έλ‹ λ°°μΉ(mini-batch)' νΉμ€ κ°„λ‹¨ν 'λ°°μΉ(batch)'λΌκ³  λ¶€λ¥Έλ‹¤.
- μ†μ‹¤ ν•¨μμ ν¬κΈ°λ¥Ό 1/mμΌλ΅ μ¤μΌ€μΌν•λ” κ³Όμ •μ€ ν•™μµ λ°μ΄ν„°μ ν¬κΈ°κ°€ μ‹¤μ‹κ°„μΌλ΅ λ°”λ€λ” ν™κ²½μ—μ„ νΉνλ‚ μ μ‘λ™ν•λ‹¤.
- m=1μΈ ν™κ²½μ„ 'μ¨λΌμΈ ν•™μµ(online/incremetal learning)'μ΄λΌκ³  λ¶€λ¥Έλ‹¤.  <br>


#### **ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²•μ νμ΄ν”„λΌμΈ**  <br>
![math_7](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/301df2fb-f84b-423b-b422-3f626a012371)  <br>

SGDλ” ν•™μµμ— ν™μ©ν•λ” λ°μ΄ν„° μƒν”μ΄ λ§¤λ² λ‹¬λΌμ§μ— λ”°λΌ μ†μ‹¤ ν•¨μμ κ·Έλν”„ λ¨μ–‘μ΄ μ•½κ°„μ”© λ°”λ€λ‹¤κ³  λ³Ό μ μμΌλ©°, μ΄λ¥Ό ν†µν•΄ <span style="color:#A073F1">μ§€μ—­ μµμ†μ μ— λΉ μ§€λ” κ²ƒμ„ λ°©μ§€ν•μ—¬ μµμ ν•΄μ— λ„λ‹¬ν•  κ°€λ¥μ„±μ„ λ†’μ΄λ” λ°©λ²•</span>μΌλ΅ μ΄ν•΄ν•  μ μλ‹¤.  <br>

λν•, λ°μ΄ν„°μ μΌλ¶€λ¥Ό κ°€μ§€κ³  κ³„μ‚°ν•κΈ° λ•λ¬Έμ— GDμ™€ λΉ„κµν–μ„ λ• <span style="color:#A073F1">μ»΄ν“¨ν„°μ λ©”λ¨λ¦¬ λ° μ—°μ‚° μμ›μ„ μΆ€ λ” ν¨μ¨μ μΌλ΅ ν™μ©</span>ν•  μ μλ‹¤.  <br>

![image](https://github.com/hyeon-n-off/hyeon-n-off.github.io/assets/161814308/01503894-91bb-40fa-af43-ec2d52e7e2b0)